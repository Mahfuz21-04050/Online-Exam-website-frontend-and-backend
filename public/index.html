<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Quiz System - Teacher & Student</title>


  <!-- KaTeX CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

  <!-- KaTeX JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

  <!-- KaTeX auto-render extension -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>


  <!-- pdfmake-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="script.js ">console.log("GLOBAL TEST:", window.goToStudentLogRegPage);

  </script>
  <!-- assign script -->
  <script src="assign.js"></script>
  <!-- exam.js -->
  <script src="exam.js"></script>

  <!--tailwind css -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!--Bootstrap CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">


  <!-- Custom CSS -->
  <link rel="stylesheet" href="styles.css">


</head>

<body>

  <div class="floating-elements"></div>

  <!-- Landing Page -->
  <div id="landingPage" class="landing-container">
    <h1 class="landing-title">ğŸ“ Advanced Quiz System</h1>
    <p class="landing-subtitle">Modern Learning Platform with Mathematical Support</p>

    <div class="role-selection">
      <div class="role-card teacher-card" onclick="goToStudentLogRegPage()">
        <span class="role-icon">ğŸ‘©â€ğŸ«</span>
        <h2 class="role-title">Teacher Dashboard</h2>
        <p class="role-description">Create and manage comprehensive quizzes with mathematical equations</p>
        <ul class="role-features">
          <li>Add mathematical equations & symbols</li>
          <li>Create unlimited questions</li>
          <li>Preview quiz before publishing</li>
          <li>Export quiz data</li>
          <li>Real-time question management</li>
        </ul>
      </div>

      <div class="role-card student-card" onclick="goToStudentLogRegPage()">
        <span class="role-icon">ğŸ“</span>
        <h2 class="role-title">Student Dashboard</h2>
        <p class="role-description">Take interactive quizzes with full mathematical equation support</p>
        <ul class="role-features">
          <li>Interactive quiz interface</li>
          <li>Mathematical equation rendering</li>
          <li>Real-time scoring</li>
          <li>Progress tracking</li>
          <li>Detailed results analysis</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Teacher Dashboard -->
  <div id="teacherDashboard" class="dashboard teacher-dashboard hidden">
    <div class="dashboard-header">
      <button class="back-btn" onclick="showLandingPage()">â† Back</button>
      <h1 class="dashboard-title">ğŸ‘©â€ğŸ« Teacher Dashboard</h1>
      <p class="dashboard-subtitle">Create amazing quizzes with mathematical equations</p>
    </div>

    <div class="teacher-panel">
      <div class="section-title">
        ğŸ“ Question Creator
      </div>

      <div class="form-section">
        <div class="form-group">
          <label class="form-label">Question Text (Mathematical expressions supported)</label>
          <div class="math-toolbar">
            <div class="math-toolbar-title">Quick Math Symbols - Click to insert:</div>
            <div class="math-buttons">
              <button class="math-btn" onclick="insertMathSymbol('\\\\frac{}{}')" title="Fraction">Â½</button>
              <button class="math-btn" onclick="insertMathSymbol('^{}')" title="Superscript">xÂ²</button>
              <button class="math-btn" onclick="insertMathSymbol('_{}')" title="Subscript">xâ‚</button>
              <button class="math-btn" onclick="insertMathSymbol('\\sqrt{}')" title="Square Root">âˆš</button>
              <button class="math-btn" onclick="insertMathSymbol('\\sqrt[3]{}')" title="Cube Root">âˆ›</button>
              <button class="math-btn" onclick="insertMathSymbol('\\pi')" title="Pi">Ï€</button>
              <button class="math-btn" onclick="insertMathSymbol('\\alpha')" title="Alpha">Î±</button>
              <button class="math-btn" onclick="insertMathSymbol('\\beta')" title="Beta">Î²</button>
              <button class="math-btn" onclick="insertMathSymbol('\\gamma')" title="Gamma">Î³</button>
              <button class="math-btn" onclick="insertMathSymbol('\\theta')" title="Theta">Î¸</button>
              <button class="math-btn" onclick="insertMathSymbol('\\sum')" title="Sum">Î£</button>
              <button class="math-btn" onclick="insertMathSymbol('\\int')" title="Integral">âˆ«</button>
              <button class="math-btn" onclick="insertMathSymbol('\\lim')" title="Limit">lim</button>
              <button class="math-btn" onclick="insertMathSymbol('\\infty')" title="Infinity">âˆ</button>
              <button class="math-btn" onclick="insertMathSymbol('\\leq')" title="Less than equal">â‰¤</button>
              <button class="math-btn" onclick="insertMathSymbol('\\geq')" title="Greater than equal">â‰¥</button>
              <button class="math-btn" onclick="insertMathSymbol('\\neq')" title="Not equal">â‰ </button>
              <button class="math-btn" onclick="insertMathSymbol('\\pm')" title="Plus minus">Â±</button>
              <button class="math-btn" onclick="insertMathSymbol('\\times')" title="Times">Ã—</button>
              <button class="math-btn" onclick="insertMathSymbol('\\div')" title="Division">Ã·</button>
              <button class="math-btn" onclick="insertMathSymbol('\\log')" title="Logarithm">log</button>
              <button class="math-btn" onclick="insertMathSymbol('\\ln')" title="Natural log">ln</button>
              <button class="math-btn" onclick="insertMathSymbol('\\sin')" title="Sine">sin</button>
              <button class="math-btn" onclick="insertMathSymbol('\\cos')" title="Cosine">cos</button>
              <button class="math-btn" onclick="insertMathSymbol('\\tan')" title="Tangent">tan</button>
            </div>
          </div>
          <textarea id="questionInput" class="form-input" rows="3"
            placeholder="Enter your question here. Use LaTeX for math: $\frac{1}{2}$, $x^2$, $\sqrt{x}$, etc."></textarea>
          <div
            style="margin-top: 10px; padding: 15px; background: #f8fafc; border-radius: 10px; border: 1px solid #e2e8f0;">
            <div style="font-weight: 600; color: #4a5568; margin-bottom: 8px;">Preview:</div>
            <div id="questionPreview" style="font-size: 1.1rem; line-height: 1.6;">Type your question to see preview...
            </div>
            <div id="choice1Preview" style="font-size: 1.1rem; line-height: 1.6; margin-top: 5px;"></div>
            <div id="choice2Preview" style="font-size: 1.1rem; line-height: 1.6; margin-top: 5px;"></div>
            <div id="choice3Preview" style="font-size: 1.1rem; line-height: 1.6; margin-top: 5px;"></div>
            <div id="choice4Preview" style="font-size: 1.1rem; line-height: 1.6; margin-top: 5px;"></div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">ğŸ“‹ Answer Choices (Mathematical expressions supported)</label>
          <div class="choices-grid">
            <div class="choice-input">
              <input type="text" id="choice1" class="form-input" placeholder="Choice A (e.g., $\frac{1}{2}$)">

              <div class="correct-marker inactive" onclick="setCorrectAnswer(0)">A</div>
            </div>
            <div class="choice-input">
              <input type="text" id="choice2" class="form-input" placeholder="Choice B (e.g., $x^2$)">
              <div class="correct-marker inactive" onclick="setCorrectAnswer(1)">B</div>
            </div>
            <div class="choice-input">
              <input type="text" id="choice3" class="form-input" placeholder="Choice C (e.g., $\sqrt{x}$)">
              <div class="correct-marker inactive" onclick="setCorrectAnswer(2)">C</div>
            </div>
            <div class="choice-input">
              <input type="text" id="choice4" class="form-input" placeholder="Choice D (e.g., $\pi r^2$)">
              <div class="correct-marker inactive" onclick="setCorrectAnswer(3)">D</div>
            </div>
          </div>
          <div style="text-align: center; margin-top: 15px;">
            <p style="color: #10b981; font-weight: 600; margin-bottom: 5px;">
              âœ… Click on A, B, C, or D to mark the correct answer
            </p>
            <p id="correctIndicator" style="color: #667eea; font-weight: 700;">
              No correct answer selected
            </p>
          </div>
        </div>

        <div class="action-buttons">
          <button class="btn btn-success" onclick="addQuestion()">â• Add Question</button>
          <button class="btn btn-warning" onclick="previewQuestion()">ğŸ‘ï¸ Preview Question</button>
          <button class="btn btn-danger" onclick="clearForm()">ğŸ—‘ï¸ Clear Form</button>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" style="color: #667eea;" id="totalQuestions">0</div>
          <div class="stat-label">Total Questions</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" style="color: #10b981;" id="readyStatus">Not Ready</div>
          <div class="stat-label">Quiz Status</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" style="color: #f59e0b;" id="mathQuestions">0</div>
          <div class="stat-label">Math Questions</div>
        </div>
      </div>

      <div class="form-section">
        <div class="section-title">
          ğŸ¯ Quiz Management
        </div>
        <div class="action-buttons">
          <button class="btn btn-teacher" onclick="publishQuiz()">ğŸš€ Publish Quiz</button>
          <button class="btn btn-primary" onclick="previewQuiz()">ğŸ‘ï¸ Preview Quiz</button>
          <button class="btn btn-warning" onclick="exportQuizPDF()">Download Exam PDF</button>
          <button class="btn btn-danger" onclick="clearAllQuestions()">ğŸ—‘ï¸ Clear All</button>
        </div>
      </div>

      <div class="form-section">
        <div class="section-title">
          ğŸ“š Questions Bank
        </div>
        <div class="questions-list" id="questionsList">
          <p style="text-align: center; color: #64748b; font-style: italic;">No questions added yet...</p>
        </div>
      </div>

      // Teacher Create & Assign Exam Section
      <!-- Stylish Header -->
      <div style="
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        padding: 30px;
        border-radius: 22px;
        margin-bottom: 35px;
        color: white;
        box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
    ">
        <h2
          style="font-size: 30px; font-weight: 800; margin-bottom: 8px; display: flex; align-items: center; gap: 12px;">
          ğŸ“š Create New Exam
        </h2>
        <p style="opacity: 0.95; font-size: 15px;">Assign questions & schedule exams with ease</p>
      </div>


      <!-- Main Exam Creation Card -->
      <div style="
        background: white;
        padding: 35px;
        border-radius: 20px;
        box-shadow: 0 25px 70px rgba(0,0,0,0.07);
        border: 1px solid #ececec;
        margin-bottom: 45px;
    ">

        <!-- Step 1 -->
        <h3
          style="font-size: 21px; font-weight: 700; color: #374151; margin-bottom: 25px; display: flex; gap: 12px; align-items: center;">
          <span
            style="background:#3b82f6; color:white; width:34px; height:34px; display:flex; align-items:center; justify-content:center; border-radius:10px;">1</span>
          Basic Exam Information
        </h3>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:25px; margin-bottom:25px;">
          <!-- Exam Title -->
          <div>
            <label style="display:block; font-size:14px; font-weight:600; color:#4b5563; margin-bottom:6px;">Exam
              Title</label>
            <input id="examTitle" type="text" placeholder="e.g., Mid Term Exam â€“ Math" style="
                           width: 100%; padding: 15px; border-radius: 12px;
                           border: 1px solid #d1d5db; font-size: 15px;
                           transition: 0.25s; outline: none;
                       "
              onfocus="this.style.borderColor='#3b82f6'; this.style.boxShadow='0 0 0 3px rgba(59,130,246,0.18)'"
              onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'">
          </div>

          <!-- Marks -->
          <div>
            <label style="display:block; font-size:14px; font-weight:600; color:#4b5563; margin-bottom:6px;">Marks Per
              Question</label>
            <input id="marksPerQuestion" type="number" min="1" value="1" style="
                           width: 100%; padding: 15px; border-radius: 12px;
                           border: 1px solid #d1d5db; font-size: 15px;
                           transition: 0.25s; outline: none;
                       "
              onfocus="this.style.borderColor='#3b82f6'; this.style.boxShadow='0 0 0 3px rgba(59,130,246,0.18)'"
              onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'">
          </div>
        </div>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:25px;">
          <!-- Start -->
          <div>
            <label style="display:block; font-size:14px; font-weight:600; color:#4b5563; margin-bottom:6px;">Start
              Time</label>
            <input id="startTime" type="datetime-local" style="
                           width: 100%; padding: 15px; border-radius: 12px;
                           border: 1px solid #d1d5db; font-size: 15px;
                           transition: 0.25s; outline: none;
                       "
              onfocus="this.style.borderColor='#3b82f6'; this.style.boxShadow='0 0 0 3px rgba(59,130,246,0.18)'"
              onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'">
          </div>

          <!-- End -->
          <div>
            <label style="display:block; font-size:14px; font-weight:600; color:#4b5563; margin-bottom:6px;">End
              Time</label>
            <input id="endTime" type="datetime-local" style="
                           width: 100%; padding: 15px; border-radius: 12px;
                           border: 1px solid #d1d5db; font-size: 15px;
                           transition: 0.25s; outline: none;
                       "
              onfocus="this.style.borderColor='#3b82f6'; this.style.boxShadow='0 0 0 3px rgba(59,130,246,0.18)'"
              onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'">
          </div>
        </div>


        <!-- Step 2 -->
        <h3
          style="font-size:21px; font-weight:700; color:#374151; margin:35px 0 20px; display:flex; gap:12px; align-items:center;">
          <span
            style="background:#10b981; color:white; width:34px; height:34px; border-radius:10px; display:flex; align-items:center; justify-content:center;">2</span>
          Select Students & Questions
        </h3>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:30px;">

          <!-- Students -->
          <div>
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
              <label style="font-size:14px; font-weight:600; color:#4b5563;">Students</label>
              <div style="display:flex; gap:10px;">
                <button onclick="selectAllStudents()"
                  style="padding:6px 12px; border-radius:6px; background:#f3f4f6;">Select
                  All</button>
                <button onclick="deselectAllStudents()"
                  style="padding:6px 12px; border-radius:6px; background:#f3f4f6;">Deselect</button>
              </div>
            </div>

            <div id="studentsContainer" style="
                    height: 300px; border:1px solid #d1d5db;
                    border-radius:12px; padding:10px; overflow-y:auto; background:#f9fafb;
                ">
              <div style="text-align:center; padding:40px; color:#9ca3af;">Loading students...</div>
            </div>

            <div style="display:flex; justify-content:space-between; margin-top:8px; font-size:13px; color:#6b7280;">
              <span id="selectedStudentsCount">0 selected</span>
              <span id="totalStudentsCount">Total: 0</span>
            </div>
          </div>

          <!-- Questions -->
          <div>
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
              <label style="font-size:14px; font-weight:600; color:#4b5563;">Questions</label>
              <div style="display:flex; gap:10px;">
                <button onclick="selectAllQuestions()"
                  style="padding:6px 12px; border-radius:6px; background:#f3f4f6;">Select
                  All</button>
                <button onclick="deselectAllQuestions()"
                  style="padding:6px 12px; border-radius:6px; background:#f3f4f6;">Deselect</button>
              </div>
            </div>

            <div id="questionsContainer" style="
                    height: 300px; border:1px solid #d1d5db;
                    border-radius:12px; padding:10px; overflow-y:auto; background:#f9fafb;
                ">
              <div style="text-align:center; padding:40px; color:#9ca3af;">Loading questions...</div>
            </div>

            <div style="display:flex; justify-content:space-between; margin-top:8px; font-size:13px; color:#6b7280;">
              <span id="selectedQuestionsCount">0 selected</span>
              <span id="totalQuestionsCount">Total: 0</span>
            </div>
          </div>
        </div>


        <!-- Step 3 -->
        <h3
          style="font-size:21px; font-weight:700; color:#374151; margin:35px 0 25px; display:flex; gap:12px; align-items:center;">
          <span
            style="background:#8b5cf6; color:white; width:34px; height:34px; border-radius:10px; display:flex; align-items:center; justify-content:center;">3</span>
          Create & Assign Exam
        </h3>

        <button onclick="createAndAssignExam()" style="
            width:100%; padding:18px; border:none; border-radius:14px;
            background: linear-gradient(135deg,#3b82f6,#1d4ed8);
            color:white; font-size:16px; font-weight:600;
            cursor:pointer; transition:0.3s; display:flex; justify-content:center; gap:12px;
        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 30px rgba(59,130,246,0.35)'"
          onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
          ğŸ“¤ Create Exam & Assign
        </button>

        <p style="text-align:center; margin-top:12px; font-size:14px; color:#6b7280;">Students will immediately receive
          the
          exam.</p>
      </div>


      <!-- Created Exams List -->
      <div style="
        background:white; padding:30px; border-radius:20px;
        border:1px solid #ececec; box-shadow:0 20px 60px rgba(0,0,0,0.06);
    ">
        <h3 style="font-size:22px; font-weight:700; color:#374151; margin-bottom:20px; display:flex; gap:10px;">
          ğŸ“ Created Exams
        </h3>

        <div id="examsList" style="min-height:140px;">
          <div style="text-align:center; padding:40px; color:#9ca3af;">
            <div
              style="width:60px; height:60px; border:2px dashed #d1d5db; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 15px; font-size:24px;">
              ğŸ“</div>
            No exams created yet.
          </div>
        </div>
      </div>










      <!-- Teacher Dashboard à¦à¦° à¦¯à§‡à¦•à§‹à¦¨à§‹ à¦¸à§à¦¥à¦¾à¦¨à§‡ à¦¯à§‹à¦— à¦•à¦°à§à¦¨ -->


      <div
        style="background: #f8f9fa; padding: 16px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #e2e8f0;">
        <h3 style="font-weight: bold; font-size: 18px; margin-bottom: 10px; color: #2d3748;">ğŸ“Š Database Status</h3>
        <div id="dbStatus" style="display: flex; align-items: center; margin-bottom: 8px;">
          <span style="animation: spin 1s linear infinite; margin-right: 8px;">ğŸ”„</span>
          <span>Connecting to database...</span>
        </div>
        <div style="font-size: 14px; color: #4a5568;">
          Questions in DB: <span id="dbQuestionCount" style="font-weight: bold;">0</span>
        </div>
      </div>

      <style>
        @keyframes spin {
          0% {
            transform: rotate(0deg);
          }

          100% {
            transform: rotate(360deg);
          }
        }

        .connected {
          color: #059669 !important;
        }

        .disconnected {
          color: #dc2626 !important;
        }
      </style>
    </div>
  </div>
  </div>

  <!-- Student Dashboard -->
  <div id="studentDashboard" class="dashboard student-dashboard hidden">
    <div class="dashboard-header">
      <button class="back-btn" onclick="showLandingPage()">â† Back</button>
      <h1 class="dashboard-title">ğŸ“ Student Dashboard</h1>
      <p class="dashboard-subtitle">Take interactive quizzes with mathematical support</p>
    </div>

    <div class="quiz-selector">
      <h2 style="color: white; margin-bottom: 20px; font-size: 2rem; font-weight: 700;">ğŸ“‹ Available Quizzes</h2>
      <div class="quiz-cards" id="quizCards">
        <div class="quiz-card" onclick="startStudentQuiz('teacher-quiz')">
          <h3 class="quiz-card-title">ğŸ“Š Teacher Created Quiz</h3>
          <div class="quiz-card-info">
            <span>ğŸ“ <span id="availableQuestions">0</span> Questions</span>
            <span id="examTime">â±ï¸</span>
          </div>
          <p class="quiz-card-description">
            Take the quiz created by your teacher with full mathematical equation support.
          </p>
          <div class="action-buttons">
            <button class="btn btn-student">Start Quiz</button>
          </div>
        </div>

        <div class="quiz-card" onclick="startStudentQuiz('sample-quiz')">
          <h3 class="quiz-card-title">ğŸ§® Sample Math Quiz</h3>
          <div class="quiz-card-info">
            <span>ğŸ“ 5 Questions</span>
            <span>â±ï¸ 30s per question</span>
          </div>
          <p class="quiz-card-description">
            Try our sample mathematics quiz with various equation types and symbols.
          </p>
          <div class="action-buttons">
            <button class="btn btn-student">Start Quiz</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quiz Interface -->
  <div id="quizContainer" class="quiz-container hidden">
    <div id="previewMode" class="preview-mode hidden">
      ğŸ” PREVIEW MODE - This is how students will see the quiz
    </div>

    <div class="quiz-header">
      <h1 class="quiz-title">ğŸ† Quiz Time</h1>
      <div class="progress-section">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">Question 1 of 1</div>
      </div>
    </div>

    <div id="quizContent">
      <div class="question-section">
        <div class="question-text" id="currentQuestion">Your question will appear here</div>
        <div class="choices-container" id="choicesContainer">
          <button class="choice-option" onclick="selectAnswer(0)">Choice A</button>
          <button class="choice-option" onclick="selectAnswer(1)">Choice B</button>
          <button class="choice-option" onclick="selectAnswer(2)">Choice C</button>
          <button class="choice-option" onclick="selectAnswer(3)">Choice D</button>
        </div>
      </div>

      <div class="quiz-controls">
        <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">â¬…ï¸ Previous</button>
        <div class="score-display" id="scoreDisplay">Score: 0/0</div>
        <div class="timer-display" id="timerDisplay">Time: 30s</div>
        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">Next â¡ï¸</button>
      </div>
    </div>

    <div id="resultsSection" class="results-section hidden">
      <h2 style="color: var(--text-dark); margin-bottom: 20px; font-size: 2.5rem; font-weight: 800;">
        ğŸ‰ Quiz Completed!
      </h2>
      <div class="final-score" id="finalScore">0/0</div>
      <div class="result-message" id="resultMessage">Great job completing the quiz!</div>
      <div id="detailedResults" style="margin: 20px 0;"></div>
      <div class="action-buttons">
        <button class="btn btn-success" onclick="restartQuiz()">ğŸ”„ Take Again</button>
        <button class="btn btn-primary" onclick="backToDashboard()">ğŸ“Š Back to Dashboard</button>
      </div>
    </div>
  </div>

</body>

</html>